{"version":3,"file":"youglish.min.js","sources":["../src/youglish.js"],"sourcesContent":["/**\r\n * mod_worcards YouGlish AMD module\r\n *\r\n * @package mod_wordcards\r\n * @author  Justin Hunt - poodll.com\r\n * *\r\n */\r\n\r\ndefine([\r\n  'jquery','core/log'\r\n], function($,log) {\r\n\r\n  var app = {\r\n    widget: false,\r\n    term: '',\r\n    views:  0,\r\n    curTrack: 0,\r\n    totalTracks: 0,\r\n    YG_ID: 'mod_wordcardsyouglish-widget',\r\n    YG_WIDGET: '#mod_wordcardsyouglish-widget',\r\n    YG_PLACEHOLDER: '.youglish-placeholder',\r\n    YGC: {\r\n      searchbox: 1,\r\n      accentpanel: 2,\r\n      title: 4,\r\n      captions:\t8,\r\n      speedcontrols: 16,\r\n      toggleui:\t32,\r\n      controlbuttons: 64,\r\n      dictionary: 128,\r\n      nearbypanel: 256,\r\n      phoneticpanel: 512,\r\n      draggable: 1024,\r\n      minimizable: 2048,\r\n      closable:\t4096,\r\n      allcaptions:\t8192,\r\n      togglelight:\t16384,\r\n      togglethumbnails:\t32768\r\n    },\r\n\r\n\r\n    //The API will call this method when the search is done\r\n    onFetchDone: function (event) {\r\n      log.debug('onFetchDone');\r\n      if (event.totalResult === 0) {\r\n        alert(\"No result found\");\r\n      }else{\r\n        app.totalTracks = event.totalResult;\r\n        app.element.find(app.YG_PLACEHOLDER).hide();\r\n        $(app.YG_WIDGET).show();\r\n      }\r\n    },\r\n\r\n    //The API will call this method when switching to a new video.\r\n    onVideoChange: function (event) {\r\n      app.curTrack = event.trackNumber;\r\n      app.views = 0;\r\n    },\r\n\r\n    //Player can take API calls now\r\n    onPlayerReady: function (event) {\r\n      log.debug('playerready');\r\n    },\r\n    //Player can take API calls now\r\n    onError: function (event) {\r\n      log.debug('error');\r\n      log.debug('error: ' + event.code);\r\n    },\r\n\r\n    // The API will call this method when a caption is consumed.\r\n    onCaptionConsumed:  function (event) {\r\n      log.debug(app.views,'views');\r\n      if (++app.views < 3) {\r\n        app.widget.replay();\r\n      }else if (app.curTrack < app.totalTracks) {\r\n        //turn autostart on for the next video\r\n        app.widget.autoStart = 1;\r\n        app.widget.next();\r\n      }\r\n    },\r\n\r\n\r\n    load: function (lang,term,accent,element) {\r\n      app.term=term;\r\n      app.element=element;\r\n\r\n      if(!lang||lang==='false'){\r\n        return;\r\n      }\r\n\r\n      log.debug('loading the term: '+ app.term);\r\n      var thefunc = function () {\r\n            //create the widget\r\n            log.debug('creating the widget');\r\n            app.element.append('<div id=\"'+app.YG_ID+'\" class=\"'+app.YG_ID+'\"></div>');\r\n            app.widget = new YG.Widget(app.YG_ID, {\r\n              width: 480,\r\n              components: app.YGC.captions | app.YGC.dictionary | app.YGC.controlbuttons | app.YGC.toggleui | app.YGC.togglelight | app.YGC.togglethumbnails,\r\n              autoStart: 1,\r\n              events: {\r\n                'onFetchDone': app.onFetchDone,\r\n                'onVideoChange': app.onVideoChange,\r\n                'onCaptionConsumed': app.onCaptionConsumed,\r\n                'onPlayerReady': app.onPlayerReady,\r\n                'onError': app.onError\r\n              }\r\n            });\r\n            // process the query\r\n            $('#' + app.YG_ID).hide();\r\n            log.debug('first fetch of the term: '+ app.term);\r\n            if(accent && accent!=='false') {\r\n              app.widget.fetch(app.term, lang, accent);\r\n            }else{\r\n              app.widget.fetch(app.term, lang);\r\n            }\r\n      };\r\n\r\n      if (typeof YG === 'undefined') {\r\n        $.getScript('https://youglish.com/public/emb/widget.js', thefunc);\r\n      } else if(app.widget===false) {\r\n        thefunc();\r\n      }else{\r\n        log.debug('reusing the widget');\r\n        $(\"#\" + app.YG_ID).detach().appendTo(element);\r\n        $('#' + app.YG_ID).hide();\r\n        log.debug('close the previous widget');\r\n        app.widget.close();\r\n        log.debug('reuse fetch the term: '+ app.term);\r\n        if(accent && accent!=='false') {\r\n          app.widget.fetch(app.term, lang, accent);\r\n        }else{\r\n          app.widget.fetch(app.term, lang);\r\n        }\r\n      }\r\n    },\r\n    clear: function () {\r\n        if(this.widget===false){return;}\r\n        this.widget.close();\r\n    },\r\n    stop: function () {\r\n        if(this.widget===false){return;}\r\n        this.widget.pause();\r\n    }\r\n  }\r\n  return app;\r\n\r\n});"],"names":["define","$","log","app","widget","term","views","curTrack","totalTracks","YG_ID","YG_WIDGET","YG_PLACEHOLDER","YGC","searchbox","accentpanel","title","captions","speedcontrols","toggleui","controlbuttons","dictionary","nearbypanel","phoneticpanel","draggable","minimizable","closable","allcaptions","togglelight","togglethumbnails","onFetchDone","event","debug","totalResult","alert","element","find","hide","show","onVideoChange","trackNumber","onPlayerReady","onError","code","onCaptionConsumed","replay","autoStart","next","load","lang","accent","thefunc","append","YG","Widget","width","components","events","fetch","getScript","detach","appendTo","close","clear","this","stop","pause"],"mappings":"AAQAA,gCAAO,CACL,SAAS,aACR,SAASC,EAAEC,SAERC,IAAM,CACRC,QAAQ,EACRC,KAAM,GACNC,MAAQ,EACRC,SAAU,EACVC,YAAa,EACbC,MAAO,+BACPC,UAAW,gCACXC,eAAgB,wBAChBC,IAAK,CACHC,UAAW,EACXC,YAAa,EACbC,MAAO,EACPC,SAAU,EACVC,cAAe,GACfC,SAAU,GACVC,eAAgB,GAChBC,WAAY,IACZC,YAAa,IACbC,cAAe,IACfC,UAAW,KACXC,YAAa,KACbC,SAAU,KACVC,YAAa,KACbC,YAAa,MACbC,iBAAkB,OAKpBC,YAAa,SAAUC,OACrB5B,IAAI6B,MAAM,eACgB,IAAtBD,MAAME,YACRC,MAAM,oBAEN9B,IAAIK,YAAcsB,MAAME,YACxB7B,IAAI+B,QAAQC,KAAKhC,IAAIQ,gBAAgByB,OACrCnC,EAAEE,IAAIO,WAAW2B,SAKrBC,cAAe,SAAUR,OACvB3B,IAAII,SAAWuB,MAAMS,YACrBpC,IAAIG,MAAQ,GAIdkC,cAAe,SAAUV,OACvB5B,IAAI6B,MAAM,gBAGZU,QAAS,SAAUX,OACjB5B,IAAI6B,MAAM,SACV7B,IAAI6B,MAAM,UAAYD,MAAMY,OAI9BC,kBAAoB,SAAUb,OAC5B5B,IAAI6B,MAAM5B,IAAIG,MAAM,WACdH,IAAIG,MAAQ,EAChBH,IAAIC,OAAOwC,SACHzC,IAAII,SAAWJ,IAAIK,cAE3BL,IAAIC,OAAOyC,UAAY,EACvB1C,IAAIC,OAAO0C,SAKfC,KAAM,SAAUC,KAAK3C,KAAK4C,OAAOf,YAC/B/B,IAAIE,KAAKA,KACTF,IAAI+B,QAAQA,QAERc,MAAa,UAAPA,MAIV9C,IAAI6B,MAAM,qBAAsB5B,IAAIE,UAChC6C,QAAU,WAERhD,IAAI6B,MAAM,uBACV5B,IAAI+B,QAAQiB,OAAO,YAAYhD,IAAIM,MAAM,YAAYN,IAAIM,MAAM,YAC/DN,IAAIC,OAAS,IAAIgD,GAAGC,OAAOlD,IAAIM,MAAO,CACpC6C,MAAO,IACPC,WAAYpD,IAAIS,IAAII,SAAWb,IAAIS,IAAIQ,WAAajB,IAAIS,IAAIO,eAAiBhB,IAAIS,IAAIM,SAAWf,IAAIS,IAAIe,YAAcxB,IAAIS,IAAIgB,iBAC9HiB,UAAW,EACXW,OAAQ,aACSrD,IAAI0B,0BACF1B,IAAImC,gCACAnC,IAAIwC,gCACRxC,IAAIqC,sBACVrC,IAAIsC,WAInBxC,EAAE,IAAME,IAAIM,OAAO2B,OACnBlC,IAAI6B,MAAM,4BAA6B5B,IAAIE,MACxC4C,QAAmB,UAATA,OACX9C,IAAIC,OAAOqD,MAAMtD,IAAIE,KAAM2C,KAAMC,QAEjC9C,IAAIC,OAAOqD,MAAMtD,IAAIE,KAAM2C,OAIjB,oBAAPI,GACTnD,EAAEyD,UAAU,4CAA6CR,UACpC,IAAb/C,IAAIC,OACZ8C,WAEAhD,IAAI6B,MAAM,sBACV9B,EAAE,IAAME,IAAIM,OAAOkD,SAASC,SAAS1B,SACrCjC,EAAE,IAAME,IAAIM,OAAO2B,OACnBlC,IAAI6B,MAAM,6BACV5B,IAAIC,OAAOyD,QACX3D,IAAI6B,MAAM,yBAA0B5B,IAAIE,MACrC4C,QAAmB,UAATA,OACX9C,IAAIC,OAAOqD,MAAMtD,IAAIE,KAAM2C,KAAMC,QAEjC9C,IAAIC,OAAOqD,MAAMtD,IAAIE,KAAM2C,SAIjCc,MAAO,YACc,IAAdC,KAAK3D,aACHA,OAAOyD,SAEhBG,KAAM,YACe,IAAdD,KAAK3D,aACHA,OAAO6D,iBAGX9D"}