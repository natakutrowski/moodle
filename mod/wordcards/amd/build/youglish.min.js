define(["jquery","core/log"],(function($,log){var app={widget:!1,term:"",views:0,curTrack:0,totalTracks:0,YG_ID:"mod_wordcardsyouglish-widget",YG_WIDGET:"#mod_wordcardsyouglish-widget",YG_PLACEHOLDER:".youglish-placeholder",YGC:{searchbox:1,accentpanel:2,title:4,captions:8,speedcontrols:16,toggleui:32,controlbuttons:64,dictionary:128,nearbypanel:256,phoneticpanel:512,draggable:1024,minimizable:2048,closable:4096,allcaptions:8192,togglelight:16384,togglethumbnails:32768},onFetchDone:function(event){log.debug("onFetchDone"),0===event.totalResult?alert("No result found"):(app.totalTracks=event.totalResult,app.element.find(app.YG_PLACEHOLDER).hide(),$(app.YG_WIDGET).show())},onVideoChange:function(event){app.curTrack=event.trackNumber,app.views=0},onPlayerReady:function(event){log.debug("playerready")},onError:function(event){log.debug("error"),log.debug("error: "+event.code)},onCaptionConsumed:function(event){log.debug(app.views,"views"),++app.views<3?app.widget.replay():app.curTrack<app.totalTracks&&(app.widget.autoStart=1,app.widget.next())},load:function(lang,term,accent,element){if(app.term=term,app.element=element,lang&&"false"!==lang){log.debug("loading the term: "+app.term);var thefunc=function(){log.debug("creating the widget"),app.element.append('<div id="'+app.YG_ID+'" class="'+app.YG_ID+'"></div>'),app.widget=new YG.Widget(app.YG_ID,{width:480,components:app.YGC.captions|app.YGC.dictionary|app.YGC.controlbuttons|app.YGC.toggleui|app.YGC.togglelight|app.YGC.togglethumbnails,autoStart:1,events:{onFetchDone:app.onFetchDone,onVideoChange:app.onVideoChange,onCaptionConsumed:app.onCaptionConsumed,onPlayerReady:app.onPlayerReady,onError:app.onError}}),$("#"+app.YG_ID).hide(),log.debug("first fetch of the term: "+app.term),accent&&"false"!==accent?app.widget.fetch(app.term,lang,accent):app.widget.fetch(app.term,lang)};"undefined"==typeof YG?$.getScript("https://youglish.com/public/emb/widget.js",thefunc):!1===app.widget?thefunc():(log.debug("reusing the widget"),$("#"+app.YG_ID).detach().appendTo(element),$("#"+app.YG_ID).hide(),log.debug("close the previous widget"),app.widget.close(),log.debug("reuse fetch the term: "+app.term),accent&&"false"!==accent?app.widget.fetch(app.term,lang,accent):app.widget.fetch(app.term,lang))}},clear:function(){!1!==this.widget&&this.widget.close()},stop:function(){!1!==this.widget&&this.widget.pause()}};return app}));

//# sourceMappingURL=youglish.min.js.map