{"version":3,"file":"ttsdialog.min.js","sources":["../src/ttsdialog.js"],"sourcesContent":["define(['jquery','core/log'], function($,log) {\n    \"use strict\"; // jshint ;_;\n\n\n    log.debug('MiniLesson YT Clip Player: initialising');\n\n    return{\n\n        init: function(uniqueid){\n\n            //fetch all the controls and data that we need\n            var dialoglines = $('#' + uniqueid + '_ttsdialogplayer .ttsdialogline');\n            var linecount = dialoglines.length;\n            var stoppedstate = '<i class=\"fa fa-play\"></i>';\n            var playingstate = '<i class=\"fa fa-stop\"></i>';\n\n            var currentline=-1;\n\n            var player = $('#' + uniqueid + '_ttsdialogplayer .ttsdialog_audioplayer');\n            var speakertext = $('#' + uniqueid + '_ttsdialogplayer .ttsdialog_text');\n            var playbutton = $('#' + uniqueid + '_ttsdialogplayer .ttsdialog_button');\n            var actor = $('#' + uniqueid + '_ttsdialogplayer .ttsdialog_actor');\n\n            //declare the functions we need to call\n            var next_play = function(){\n                log.debug(\"currentline: \" + currentline);\n                log.debug(\"linecount: \" + linecount);\n                currentline++;\n                if (currentline >= linecount){\n                    currentline =-1;\n                    playbutton.html(stoppedstate);\n                    speakertext.text(\" \");\n                    switch_actor('none');\n                    return;\n                }\n                player.attr('src',dialoglines.eq(currentline).data('audiourl'));\n                var speaker = dialoglines.eq(currentline).data('speaker');\n                if(speaker=='soundeffect'){\n                    switch_actor('none');\n                    speakertext.text(' ');\n                }else{\n                    switch_actor(speaker);\n                    speakertext.text(dialoglines.eq(currentline).data('speakertext'));\n                }\n                player[0].play();\n            };\n\n            var switch_actor = function(speaker){\n                switch(speaker){\n                    case 'none':\n                        actor.removeClass('rolea');\n                        actor.removeClass('roleb');\n                        actor.removeClass('rolec');\n                        actor.addClass('rolenone');\n                        break;\n\n                    case 'a':\n                        actor.removeClass('rolenone');\n                        actor.removeClass('roleb');\n                        actor.removeClass('rolec');\n                        actor.addClass('rolea');\n                        break;\n                    case 'b':\n                        actor.removeClass('rolenone');\n                        actor.removeClass('rolea');\n                        actor.removeClass('rolec');\n                        actor.addClass('roleb');\n                        break;\n                    case 'c':\n                        actor.removeClass('rolenone');\n                        actor.removeClass('rolea');\n                        actor.removeClass('roleb');\n                        actor.addClass('rolec');\n                        break;\n                }\n\n            };//end of switch actor\n\n            //register_events\n            player[0].addEventListener('ended', next_play);\n            playbutton.click(function(){\n                if(!(player[0].paused)){\n                    currentline--;\n                    player[0].pause();\n                    playbutton.html(stoppedstate);\n                }else{\n                    next_play();\n                    playbutton.html(playingstate);\n                }\n\n            });\n\n        }//end of init function\n\n    };//end of return value\n});"],"names":["define","$","log","debug","init","uniqueid","dialoglines","linecount","length","currentline","player","speakertext","playbutton","actor","next_play","html","text","switch_actor","attr","eq","data","speaker","play","removeClass","addClass","addEventListener","click","paused","pause"],"mappings":"AAAAA,kCAAO,CAAC,SAAS,aAAa,SAASC,EAAEC,YAIrCA,IAAIC,MAAM,2CAEJ,CAEFC,KAAM,SAASC,cAGPC,YAAcL,EAAE,IAAMI,SAAW,mCACjCE,UAAYD,YAAYE,OAIxBC,aAAa,EAEbC,OAAST,EAAE,IAAMI,SAAW,2CAC5BM,YAAcV,EAAE,IAAMI,SAAW,oCACjCO,WAAaX,EAAE,IAAMI,SAAW,sCAChCQ,MAAQZ,EAAE,IAAMI,SAAW,qCAG3BS,UAAY,cACZZ,IAAIC,MAAM,gBAAkBM,aAC5BP,IAAIC,MAAM,cAAgBI,aAC1BE,aACmBF,iBACfE,aAAc,EACdG,WAAWG,KAjBA,8BAkBXJ,YAAYK,KAAK,UACjBC,aAAa,QAGjBP,OAAOQ,KAAK,MAAMZ,YAAYa,GAAGV,aAAaW,KAAK,iBAC/CC,QAAUf,YAAYa,GAAGV,aAAaW,KAAK,WACnC,eAATC,SACCJ,aAAa,QACbN,YAAYK,KAAK,OAEjBC,aAAaI,SACbV,YAAYK,KAAKV,YAAYa,GAAGV,aAAaW,KAAK,iBAEtDV,OAAO,GAAGY,QAGVL,aAAe,SAASI,gBACjBA,aACE,OACDR,MAAMU,YAAY,SAClBV,MAAMU,YAAY,SAClBV,MAAMU,YAAY,SAClBV,MAAMW,SAAS,sBAGd,IACDX,MAAMU,YAAY,YAClBV,MAAMU,YAAY,SAClBV,MAAMU,YAAY,SAClBV,MAAMW,SAAS,mBAEd,IACDX,MAAMU,YAAY,YAClBV,MAAMU,YAAY,SAClBV,MAAMU,YAAY,SAClBV,MAAMW,SAAS,mBAEd,IACDX,MAAMU,YAAY,YAClBV,MAAMU,YAAY,SAClBV,MAAMU,YAAY,SAClBV,MAAMW,SAAS,WAO3Bd,OAAO,GAAGe,iBAAiB,QAASX,WACpCF,WAAWc,OAAM,WACRhB,OAAO,GAAGiB,QAKXb,YACAF,WAAWG,KAzEA,gCAoEXN,cACAC,OAAO,GAAGkB,QACVhB,WAAWG,KAvEA"}