define(["jquery","core/ajax","core/str"],(function($,ajax,str){const SELECTOR_DATA_SET='*[data-action="minilesson-set-my-words"]',SELECTOR_MY_WORDS_DIV="#my-words-ids",SELECTOR_MY_WORDS_ACTION_BTN_ID=".minilesson-mywords-action-",SELECTOR_WORDPOOL_COUNTS=".wordpool-count",CLASS_DISABLED="disabled",CLASS_BTN_NOT_IN_MY_WORDS="btn-outline-primary",CLASS_BTN_IN_MY_WORDS="btn-primary",EVENT_CLICK="click",EVENT_KEYDOWN="keydown",DATA_TERM_ID="data-termid",DATA_MY_WORDS_IDS="data-my-words-term-ids";var stringStore={};const initStrings=function(callback){str.get_strings([{key:"addtomywords",component:"mod_minilesson"},{key:"removefrommywords",component:"mod_minilesson"}]).done((function(strings){stringStore=strings,"function"==typeof callback&&callback()}))},initButtonListeners=function(){var doMyWords=function(e){if("keydown"===e.type&&13!==e.keyCode&&32!==e.keyCode)return;e.stopPropagation();const currTar=$(e.currentTarget),buttons=$(SELECTOR_MY_WORDS_ACTION_BTN_ID+currTar.attr(DATA_TERM_ID)),termId=buttons.attr(DATA_TERM_ID);if(!currTar.hasClass(CLASS_DISABLED)){e.preventDefault(),buttons.addClass(CLASS_DISABLED),$(SELECTOR_WORDPOOL_COUNTS).fadeOut();const newStatus=buttons.hasClass(CLASS_BTN_IN_MY_WORDS)?0:1;ajax.call([{methodname:"mod_minilesson_set_my_words",args:{termid:termId,newstatus:newStatus}}])[0].done((function(response){response.success&&(buttons.removeClass(CLASS_DISABLED),response.newStatus?(buttons.addClass(CLASS_BTN_IN_MY_WORDS),buttons.removeClass(CLASS_BTN_NOT_IN_MY_WORDS),buttons.attr("title",stringStore[1])):(buttons.removeClass(CLASS_BTN_IN_MY_WORDS),buttons.addClass(CLASS_BTN_NOT_IN_MY_WORDS),buttons.attr("title",stringStore[0])))})).fail((function(){buttons.removeClass(CLASS_DISABLED)}))}};$(SELECTOR_DATA_SET).on(EVENT_CLICK,doMyWords),$(SELECTOR_DATA_SET).on(EVENT_KEYDOWN,doMyWords)},applyButtonStatuses=function(){const myWordsDiv=$(SELECTOR_MY_WORDS_DIV);if(myWordsDiv){return JSON.parse(myWordsDiv.attr(DATA_MY_WORDS_IDS)).forEach((id=>{const btn=$(SELECTOR_MY_WORDS_ACTION_BTN_ID+id);btn.hasClass(CLASS_BTN_IN_MY_WORDS)||btn.addClass(CLASS_BTN_IN_MY_WORDS).removeClass(CLASS_BTN_NOT_IN_MY_WORDS).attr("title",stringStore[1])})),!0}};return{init:function(){$(document).ready((function(){initStrings(),initButtonListeners()}))},initFromFeedbackPage:function(){initStrings(applyButtonStatuses),initButtonListeners()}}}));

//# sourceMappingURL=mywords.min.js.map